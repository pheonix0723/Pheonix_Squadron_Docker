{% extends "navBar.html" %}
{% block content %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Retinal Disease Detection</title>
  <!-- Add your CSS file link here -->
  <link rel="stylesheet" href="/static/css/styles.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/fontawesome.min.css"
    integrity="sha384-QYIZto+st3yW+o8+5OHfT6S482Zsvz2WfOzpFSXMF9zqeLcFV0/wlZpMtyFcZALm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/flatpickr@4.6.9/dist/flatpickr.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr@4.6.9/dist/flatpickr.min.css">
  <script src="//d3js.org/d3.v3.min.js"></script>

</head>
<!DOCTYPE html>
<html lang="en">

<body>

    <section id="Analysis">
        <div class="dropdrown">
          <form class="form-inline" id="form-inline" style="padding-left: 40px;" action="/getdata" method="POST">
            <h4 style="color:rgb(20, 49, 77)">Search for a Report ?</h4>
            <div class="row ">
              <div class="col-md-4">
                <select class="form-control" name="patient_Id" id="patient_Id" required>

                  <option disabled selected>Select Patient ID</option>
                  <option value="234789541245 - Olivia Johnson">234789541245 - Olivia Johnson</option>
                  <option value="234598762453 - Robert Campbell">234598762453 - Robert Campbell</option>
                  <option value="246809753198 - John Williams">246809753198 - John Williams</option>
                  <option value="135790864213 - Niklaus Stevenson">135790864213 - Niklaus Stevenson</option>
                  <option value="147987357627 - Henry Stewart">147987357627 - Henry Stewart</option>
    
                </select>
              </div>
              <div class="col-md-4 ">
                <button type="submit" class="btn btn-primary mb-2">Submit</button>
              </div>
            </div>
          </form>
        </div>
    
        {% if img %}
        <section id = "report">
        <div class = "reportcard">
          <div class="row" style="margin-right:0px;important;padding-right:0px;width: 960px;">
            <div class="card3" style="width:850px;">
              <div class="card-body6" >Name : {{patient_Name}}</div>
            </div>
          </div>
          <br>
    
          <div class="row">
            <div class="col-md-5">
              <div class="image-box" style = "height: 288px;">
                <img src="{{ img }}" alt = "Image Not Found">
              </div>
            </div>
    
            <div class="col-md-6">

              <div class="row" style="width: 450px;">
                <div class="card4" >
                  <div class="card-body7">Date of Test : {{ test_Date }}</div>
                </div>
              </div>
              <br>
    
              <div class="row" >
                <div class="card4" style="width: 450px;">
                  <div class="card-body7" id = "age_Display"></div>
                </div>
              </div>
              <br>
    
              <div class="row" >
                <div class="card4" style="width: 450px;">
                  <div class="card-body7" >Gender : {{patient_Gender}}</div>
                </div>
              </div>
              <br>
        
              <div class="row" >
                <!-- <div class="col-md-5"> -->
                <div class="card4" style="width: 450px;">
                  <div class="card-body7" style="background-color:
                  {% if probability > 60 %} 
                  #fb5252;color: white
                  {% elif probability < 30 %}
                  #93f75e;
                  {% else %}
                  #f9fc5f;
                  {% endif %}">Probability of Having Diabetic Retinopathy : <b>{{ probability }} %</b></div>
                  </div>
                </div>
              </div>

              <!-- <div class="sc-gauge" style="width:200px; height:200px; margin:50px auto;">
                <div class="sc-background" style="position:relative; height:100px; margin-bottom:10px; 
                background-color:#fff; border-radius:150px 150px 0 0; overflow:hidden; 
                text-align:center;">
                  <div class="sc-percentage" style="position:absolute; top:100px; left:-200%; 
                  width:400%; height:400%; margin-left:100px; background-color:
                  {% if probability > 60 %} 
                  #fb5252;color: white
                  {% elif probability < 30 %}
                  #93f75e;
                  {% else %}
                  #f9fc5f;
                  {% endif %}
                  transform:rotate({{probability*1.8}}deg); transform-origin:top center;"></div>
                  <div class="sc-mask" style="position:absolute; top:20px; right:20px; left:20px;
                   height:80px; background-color:#fff; border-radius:150px 150px 0 0"></div>
                  <span class="sc-value" style="position:absolute; top:50%; left:0; width:100%; 
                   font-size:44px; font-weight:700; padding-bottom: 30px;">{{ probability }}</span>
                </div>
                <span class="sc-min" style="float:left;">0</span>
                <span class="sc-max" style="float:right;">100</span>
            </div>
            </div> -->

            <div id = "dr_Meter"></div>

          </div>
        </div>
        </section>
      </section>
      
        <script>
            function removeTable() {
            var table = document.getElementById("patientTable");
            table.style.display = "none";
          }
    
          function calculate_Age(dateOfBirth) {
            var today = new Date();
            var birthDate = new Date(dateOfBirth);
    
            var yearsDiff = today.getFullYear() - birthDate.getFullYear();
    
            if (today.getMonth() < birthDate.getMonth() ||
              (today.getMonth() === birthDate.getMonth() && today.getDate() < birthDate.getDate())) 
                {yearsDiff--;}
            return yearsDiff;
          }
    
          var ageDisplay = document.getElementById('age_Display');
          ageDisplay.textContent = "Age : " + calculate_Age("{{patient_Dob}}");
          const context = canvas.getContext("2d");
          var dr_Display = document.getElementById("dr_Meter");
        </script>
    
        {% endif %}
{% endblock %}
</body>

</html>